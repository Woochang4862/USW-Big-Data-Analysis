# 타깃 변수 HE_D3_label 중심 EDA 요약

## 문제 정의
- **타깃 변수**: `HE_D3_label` (비타민D 상태)
  - 0: 비타민D 결핍 (HE_D3 ≤ 20 ng/mL)
  - 1: 비타민D 충분 (HE_D3 > 20 ng/mL)
- **목표**: X_test로 Y_test를 예측하는 이진 분류 문제

## 1. 타깃 변수 기본 통계

### 분포
- **클래스 0 (결핍)**: 4,364명 (40.17%)
- **클래스 1 (충분)**: 6,500명 (59.83%)
- **총 샘플 수**: 10,864명
- **클래스 불균형 비율**: 1.49:1 (경미한 불균형)

### Train/Test 분할
- Train: 8,691명 (결핍 40.17%, 충분 59.83%)
- Test: 2,173명 (결핍 40.17%, 충분 59.83%)
- **분할이 균형적이며 타깃 분포가 일치함**

## 2. 인구통계 특성

### 성별/연령대별 분포

| 성별 | 연령대 | 결핍(0) | 충분(1) | 충분 비율 |
|------|--------|---------|---------|-----------|
| 남성 | 19-30 | 430 | 186 | 30.2% |
| 남성 | 31-50 | 668 | 705 | 51.3% |
| 남성 | 51-65 | 525 | 841 | 61.6% |
| 남성 | 65+ | 430 | 951 | 68.9% |
| 여성 | 19-30 | 479 | 224 | 31.9% |
| 여성 | 31-50 | 857 | 956 | 52.7% |
| 여성 | 51-65 | 537 | 1,346 | 71.5% |
| 여성 | 65+ | 438 | 1,291 | 74.7% |

**주요 발견**:
- 연령이 높을수록 비타민D 충분 비율이 증가
- 여성이 남성보다 비타민D 충분 비율이 높음 (특히 51세 이상)
- 65세 이상 여성의 충분 비율이 가장 높음 (74.7%)

## 3. 주요 임상 지표와 타깃 변수 관계

### 주요 임상 지표별 평균값 비교

| 지표 | 결핍(0) | 충분(1) | 차이 |
|------|---------|---------|------|
| BMI | 24.34 | 23.89 | 충분군이 낮음 |
| 공복혈당 (mg/dL) | 101.41 | 101.08 | 유사 |
| HbA1c (%) | 5.59 | 5.65 | 충분군이 약간 높음 |
| 총콜레스테롤 (mg/dL) | 186.88 | 186.04 | 유사 |
| **HDL (mg/dL)** | **56.01** | **58.02** | **충분군이 높음** |
| **중성지방 (mg/dL)** | **132.41** | **122.96** | **충분군이 낮음** |
| LDL (mg/dL) | 114.00 | 112.32 | 충분군이 약간 낮음 |
| 헤모글로빈 (g/dL) | 13.84 | 13.66 | 결핍군이 약간 높음 |

**주요 발견**:
- HDL 콜레스테롤: 충분군이 결핍군보다 평균 2 mg/dL 높음
- 중성지방: 충분군이 결핍군보다 평균 9.5 mg/dL 낮음
- BMI: 충분군이 결핍군보다 약간 낮음

## 4. 만성질환과 타깃 변수 관계

### 고혈압, 당뇨병, 이상지질혈증 유병률
- 만성질환 유무에 따른 타깃 분포는 큰 차이가 없음
- 모든 질환군에서 충분 비율이 약 65-70%로 유사

## 5. 건강행태와 타깃 변수 관계

### 주요 건강행태
- **현재흡연**: 흡연자와 비흡연자 간 타깃 분포 차이 미미
- **월간음주**: 음주자와 비음주자 간 타깃 분포 차이 미미
- **유산소활동**: 활동군과 비활동군 간 타깃 분포 차이 미미
- **스트레스인지**: 스트레스 수준에 따른 타깃 분포 차이 미미

## 6. 영양 섭취와 타깃 변수 관계

### 영양 섭취량 비교 (중앙값)

| 영양소 | 결핍(0) | 충분(1) | 차이 |
|--------|---------|---------|------|
| 1일 에너지 (kcal) | 1,680 | 1,620 | 결핍군이 높음 |
| 단백질 (g) | 61.6 | 60.6 | 유사 |
| 지방 (g) | 41.0 | 37.8 | 결핍군이 높음 |
| 탄수화물 (g) | 240.4 | 238.0 | 유사 |
| **식이섬유 (g)** | **21.3** | **23.3** | **충분군이 높음** |
| 나트륨 (mg) | 2,865 | 2,731 | 결핍군이 높음 |
| **칼슘 (mg)** | **417.1** | **446.9** | **충분군이 높음** |
| **비타민C (mg)** | **40.4** | **46.0** | **충분군이 높음** |
| **비타민D (μg)** | **1.42** | **1.67** | **충분군이 높음** |

**주요 발견**:
- 칼슘, 식이섬유, 비타민C, 비타민D: 충분군이 결핍군보다 높음
- 에너지, 지방, 나트륨: 결핍군이 충분군보다 높음 (비만 관련 가능성)

## 7. 결측 패턴

### 주요 변수별 결측률 (타깃별)

| 변수 | 결핍(0) | 충분(1) |
|------|---------|---------|
| HE_BMI | 1.92% | 1.65% |
| HE_glu | 0% | 0% |
| HE_HbA1c | 0.25% | 0.23% |
| HE_chol | 0% | 0% |
| HE_TG | 0% | 0% |
| N_EN | 4.17% | 3.95% |
| N_VITD | 4.17% | 3.95% |

**결측률이 낮아 처리 용이**

## 8. 상관관계 분석

### 타깃 변수와의 상관관계 (절댓값 기준 상위)
1. 연령 (age): 양의 상관관계 (연령↑ → 충분↑)
2. 성별 (sex): 양의 상관관계 (여성 → 충분↑)
3. HDL: 양의 상관관계
4. 중성지방: 음의 상관관계
5. 칼슘 섭취: 양의 상관관계
6. 비타민D 섭취: 양의 상관관계

## 9. 모델링 권장사항

### 1. 데이터 전처리
- **결측치 처리**: 
  - 임상 지표는 결측률이 낮아 평균/중앙값 대체 가능
  - 영양 섭취 변수는 4% 결측률로 적절한 대체 방법 필요
- **이상치 처리**: 
  - 중성지방, 공복혈당 등 극단치 존재 → 로그 변환 또는 클리핑 고려
- **범주형 변수**: 
  - -1 값(비해당)을 NaN으로 변환 후 처리

### 2. 특성 엔지니어링
- **연령 그룹**: 연령대별로 비타민D 충분 비율이 다르므로 연령 그룹 변수 생성
- **성별-연령 교호작용**: 성별과 연령의 교호작용 변수 고려
- **영양 지수**: 칼슘, 비타민D, 비타민C를 결합한 영양 지수 생성
- **계절 변수**: 조사 시기(월) 변수 추가 (비타민D는 일조량과 관련)

### 3. 모델 선택
- **기본 모델**: 
  - Logistic Regression (해석 가능성)
  - Random Forest (특성 중요도 파악)
- **고급 모델**: 
  - XGBoost, LightGBM, CatBoost (성능 향상)
  - Neural Network (비선형 관계 학습)
- **앙상블**: 
  - 여러 모델의 스태킹 또는 보팅

### 4. 평가 지표
- **주요 지표**: 
  - Accuracy (클래스 불균형이 경미하므로 적절)
  - F1-score (클래스별 성능 확인)
  - ROC-AUC (임계값 조정 가능)
- **클래스 불균형 대응**: 
  - 경미한 불균형이므로 기본 모델로 시작
  - 필요시 SMOTE 또는 클래스 가중치 조정

### 5. 중요한 특성 (예상)
1. **인구통계**: 연령, 성별
2. **임상 지표**: HDL, 중성지방, BMI
3. **영양 섭취**: 칼슘, 비타민D, 비타민C, 식이섬유
4. **생활습관**: 신체활동, 일조량 관련 변수

## 10. 다음 단계

1. **상세 특성 분석**: 
   - 변수별 타깃 분포 시각화
   - 특성 중요도 분석
2. **전처리 파이프라인 구축**: 
   - 결측치 처리
   - 스케일링
   - 인코딩
3. **베이스라인 모델 구축**: 
   - Logistic Regression
   - Random Forest
4. **모델 최적화**: 
   - 하이퍼파라미터 튜닝
   - 특성 선택
5. **앙상블 모델**: 
   - 여러 모델 결합
   - 스태킹/보팅

## 참고
- 생성된 시각화 파일:
  - `results/figures/target_analysis_overview.png`
  - `results/figures/target_correlation_heatmap.png`
  - `results/figures/target_by_age_group.png`
  - `results/figures/target_nutrition_distribution.png`


